// MIT License
// 
// Copyright (c) 2024 Peter Dennis Bartok 
// 
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
// 
// The above copyright notice and this permission notice shall be included in all
// copies or substantial portions of the Software.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// SOFTWARE.
//

using System;
using System.Runtime.CompilerServices;

namespace PQnet.Digest {
	public static class Sha256 {
		private static readonly byte[] iv_256 = {
			0x6a, 0x09, 0xe6, 0x67, 0xbb, 0x67, 0xae, 0x85,
			0x3c, 0x6e, 0xf3, 0x72, 0xa5, 0x4f, 0xf5, 0x3a,
			0x51, 0x0e, 0x52, 0x7f, 0x9b, 0x05, 0x68, 0x8c,
			0x1f, 0x83, 0xd9, 0xab, 0x5b, 0xe0, 0xcd, 0x19
		};


		public static void sha256_inc_init(byte[] state) {
			for (int i = 0; i < 32; ++i) {
				state[i] = iv_256[i];
			}
			for (int i = 32; i < 40; ++i) {
				state[i] = 0;
			}
		}

		public static void sha256_inc_blocks(byte[] state, byte[] in_buf, int inblocks) {
			ulong bytes;

			bytes = load_bigendian_64(state, 32);

			crypto_hashblocks_sha256(state, in_buf, 64 * inblocks);
			bytes += 64 * (ulong)inblocks;

			store_bigendian_64(state, 32, bytes);
		}

		public static void sha256_inc_finalize(byte[] out_buf, byte[] state, byte[] in_buf, int inlen) {
			byte[] padded;
			ulong bytes;
			int in_buf_offset;

			padded = new byte[128];
			bytes = load_bigendian_64(state, 32) + (ulong)inlen;
			in_buf_offset = 0;

			crypto_hashblocks_sha256(state, in_buf, inlen);

			in_buf_offset += inlen;
			inlen &= 63;
			in_buf_offset -= inlen;

			for (int i = 0; i < inlen; ++i) {
				padded[i] = in_buf[i + in_buf_offset];
			}
			padded[inlen] = 0x80;

			if (inlen < 56) {
				for (int i = inlen + 1; i < 56; ++i) {
					padded[i] = 0;
				}
				padded[56] = (byte)(bytes >> 53);
				padded[57] = (byte)(bytes >> 45);
				padded[58] = (byte)(bytes >> 37);
				padded[59] = (byte)(bytes >> 29);
				padded[60] = (byte)(bytes >> 21);
				padded[61] = (byte)(bytes >> 13);
				padded[62] = (byte)(bytes >> 5);
				padded[63] = (byte)(bytes << 3);
				crypto_hashblocks_sha256(state, padded, 64);
			} else {
				for (int i = inlen + 1; i < 120; ++i) {
					padded[i] = 0;
				}
				padded[120] = (byte)(bytes >> 53);
				padded[121] = (byte)(bytes >> 45);
				padded[122] = (byte)(bytes >> 37);
				padded[123] = (byte)(bytes >> 29);
				padded[124] = (byte)(bytes >> 21);
				padded[125] = (byte)(bytes >> 13);
				padded[126] = (byte)(bytes >> 5);
				padded[127] = (byte)(bytes << 3);
				crypto_hashblocks_sha256(state, padded, 128);
			}

			for (int i = 0; i < 32; ++i) {
				out_buf[i] = state[i];
			}

		}

		public static void sha256(byte[] out_buf, byte[] in_buf, int inlen) {
			byte[] state;

			state = new byte[40];

			sha256_inc_init(state);
			sha256_inc_finalize(out_buf, state, in_buf, inlen);
		}

		/**
	 * mgf1 function based on the SHA-256 hash function
	 * Note that inlen should be sufficiently small that it still allows for
	 * an array to be allocated on the stack. Typically 'in' is merely a seed.
	 * Outputs outlen number of bytes
	 */
		public static void mgf1_256(byte[] out_buf, int outlen, byte[] in_buf, int inlen) {
			byte[] in_tmp;
			byte[] out_tmp;
			int i;
			int out_buf_offset;

			out_tmp = new byte[32];
			in_tmp = new byte[inlen + 4];
			out_buf_offset = 0;

			Array.Copy(in_buf, 0, in_tmp, 0, inlen);

			/* While we can fit in at least another full block of SHA256 output.. */
			for (i = 0; (i + 1) * 32 <= outlen; i++) {
				store_bigendian_32(in_tmp, inlen, (uint)i);
				sha256(out_buf, in_tmp, inlen + 4);
				out_buf_offset += 32;
			}
			/* Until we cannot anymore, and we fill the remainder. */
			if (outlen > (i * 32)) {
				store_bigendian_32(in_tmp, inlen, (uint)i);
				sha256(out_tmp, in_tmp, inlen + 4);
				Array.Copy(out_tmp, 0, out_buf, out_buf_offset, outlen - (i * 32));
			}
		}

		[MethodImpl(MethodImplOptions.AggressiveInlining)]
		private static uint load_bigendian_32(byte[] x, int offset) {
			return (uint)((x[offset + 3] & 0xFF) | ((x[offset + 2] & 0xFF) << 8) | ((x[offset + 1] & 0xFF) << 16) | ((x[offset] & 0xFF) << 24));
		}

		[MethodImpl(MethodImplOptions.AggressiveInlining)]
		private static ulong load_bigendian_64(byte[] x, int offset) {
			return (ulong)((x[offset + 7] & 0xFF) | ((x[offset + 6] & 0xFF) << 8) | ((x[offset + 5] & 0xFF) << 16) | ((x[offset + 4] & 0xFF) << 24) | ((x[offset + 3] & 0xFF) << 32) | ((x[offset + 2] & 0xFF) << 40) | ((x[offset + 1] & 0xFF) << 48) | ((x[offset] & 0xFF) << 56));
		}

		[MethodImpl(MethodImplOptions.AggressiveInlining)]
		private static void store_bigendian_32(byte[] x, int offset, uint u) {
			x[offset + 3] = (byte)u;
			x[offset + 2] = (byte)(u >> 8);
			x[offset + 1] = (byte)(u >> 16);
			x[offset] = (byte)(u >> 24);
		}

		[MethodImpl(MethodImplOptions.AggressiveInlining)]
		private static void store_bigendian_64(byte[] x, int offset, ulong u) {
			x[offset + 7] = (byte)u;
			x[offset + 6] = (byte)(u >> 8);
			x[offset + 5] = (byte)(u >> 16);
			x[offset + 4] = (byte)(u >> 24);
			x[offset + 3] = (byte)(u >> 32);
			x[offset + 2] = (byte)(u >> 40);
			x[offset + 1] = (byte)(u >> 48);
			x[offset] = (byte)(u >> 56);
		}

		private static int crypto_hashblocks_sha256(byte[] statebytes, byte[] in_buf, int inlen) {
			uint[] state;
			uint a;
			uint b;
			uint c;
			uint d;
			uint e;
			uint f;
			uint g;
			uint h;
			uint T1;
			uint T2;
			int in_buf_offset;

			in_buf_offset = 0;
			state = new uint[8];

			a = load_bigendian_32(statebytes, 0);
			state[0] = a;
			b = load_bigendian_32(statebytes, 4);
			state[1] = b;
			c = load_bigendian_32(statebytes, 8);
			state[2] = c;
			d = load_bigendian_32(statebytes, 12);
			state[3] = d;
			e = load_bigendian_32(statebytes, 16);
			state[4] = e;
			f = load_bigendian_32(statebytes, 20);
			state[5] = f;
			g = load_bigendian_32(statebytes, 24);
			state[6] = g;
			h = load_bigendian_32(statebytes, 28);
			state[7] = h;

			while (inlen >= 64) {
				uint w0 = load_bigendian_32(in_buf, in_buf_offset + 0);
				uint w1 = load_bigendian_32(in_buf, in_buf_offset + 4);
				uint w2 = load_bigendian_32(in_buf, in_buf_offset + 8);
				uint w3 = load_bigendian_32(in_buf, in_buf_offset + 12);
				uint w4 = load_bigendian_32(in_buf, in_buf_offset + 16);
				uint w5 = load_bigendian_32(in_buf, in_buf_offset + 20);
				uint w6 = load_bigendian_32(in_buf, in_buf_offset + 24);
				uint w7 = load_bigendian_32(in_buf, in_buf_offset + 28);
				uint w8 = load_bigendian_32(in_buf, in_buf_offset + 32);
				uint w9 = load_bigendian_32(in_buf, in_buf_offset + 36);
				uint w10 = load_bigendian_32(in_buf, in_buf_offset + 40);
				uint w11 = load_bigendian_32(in_buf, in_buf_offset + 44);
				uint w12 = load_bigendian_32(in_buf, in_buf_offset + 48);
				uint w13 = load_bigendian_32(in_buf, in_buf_offset + 52);
				uint w14 = load_bigendian_32(in_buf, in_buf_offset + 56);
				uint w15 = load_bigendian_32(in_buf, in_buf_offset + 60);

				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x428a2f98 + w0;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x71374491 + w1;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xb5c0fbcf + w2;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xe9b5dba5 + w3;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x3956c25b + w4;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x59f111f1 + w5;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x923f82a4 + w6;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xab1c5ed5 + w7;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xd807aa98 + w8;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x12835b01 + w9;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x243185be + w10;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x550c7dc3 + w11;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x72be5d74 + w12;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x80deb1fe + w13;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x9bdc06a7 + w14;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xc19bf174 + w15;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;



				w0 = ((((w14) >> (17)) | ((w14) << (32 - 17))) ^ (((w14) >> (19)) | ((w14) << (32 - 19))) ^ ((w14) >> (10))) + w9 + ((((w1) >> (7)) | ((w1) << (32 - 7))) ^ (((w1) >> (18)) | ((w1) << (32 - 18))) ^ ((w1) >> (3))) + w0;
				;
				w1 = ((((w15) >> (17)) | ((w15) << (32 - 17))) ^ (((w15) >> (19)) | ((w15) << (32 - 19))) ^ ((w15) >> (10))) + w10 + ((((w2) >> (7)) | ((w2) << (32 - 7))) ^ (((w2) >> (18)) | ((w2) << (32 - 18))) ^ ((w2) >> (3))) + w1;
				;
				w2 = ((((w0) >> (17)) | ((w0) << (32 - 17))) ^ (((w0) >> (19)) | ((w0) << (32 - 19))) ^ ((w0) >> (10))) + w11 + ((((w3) >> (7)) | ((w3) << (32 - 7))) ^ (((w3) >> (18)) | ((w3) << (32 - 18))) ^ ((w3) >> (3))) + w2;
				;
				w3 = ((((w1) >> (17)) | ((w1) << (32 - 17))) ^ (((w1) >> (19)) | ((w1) << (32 - 19))) ^ ((w1) >> (10))) + w12 + ((((w4) >> (7)) | ((w4) << (32 - 7))) ^ (((w4) >> (18)) | ((w4) << (32 - 18))) ^ ((w4) >> (3))) + w3;
				;
				w4 = ((((w2) >> (17)) | ((w2) << (32 - 17))) ^ (((w2) >> (19)) | ((w2) << (32 - 19))) ^ ((w2) >> (10))) + w13 + ((((w5) >> (7)) | ((w5) << (32 - 7))) ^ (((w5) >> (18)) | ((w5) << (32 - 18))) ^ ((w5) >> (3))) + w4;
				;
				w5 = ((((w3) >> (17)) | ((w3) << (32 - 17))) ^ (((w3) >> (19)) | ((w3) << (32 - 19))) ^ ((w3) >> (10))) + w14 + ((((w6) >> (7)) | ((w6) << (32 - 7))) ^ (((w6) >> (18)) | ((w6) << (32 - 18))) ^ ((w6) >> (3))) + w5;
				;
				w6 = ((((w4) >> (17)) | ((w4) << (32 - 17))) ^ (((w4) >> (19)) | ((w4) << (32 - 19))) ^ ((w4) >> (10))) + w15 + ((((w7) >> (7)) | ((w7) << (32 - 7))) ^ (((w7) >> (18)) | ((w7) << (32 - 18))) ^ ((w7) >> (3))) + w6;
				;
				w7 = ((((w5) >> (17)) | ((w5) << (32 - 17))) ^ (((w5) >> (19)) | ((w5) << (32 - 19))) ^ ((w5) >> (10))) + w0 + ((((w8) >> (7)) | ((w8) << (32 - 7))) ^ (((w8) >> (18)) | ((w8) << (32 - 18))) ^ ((w8) >> (3))) + w7;
				;
				w8 = ((((w6) >> (17)) | ((w6) << (32 - 17))) ^ (((w6) >> (19)) | ((w6) << (32 - 19))) ^ ((w6) >> (10))) + w1 + ((((w9) >> (7)) | ((w9) << (32 - 7))) ^ (((w9) >> (18)) | ((w9) << (32 - 18))) ^ ((w9) >> (3))) + w8;
				;
				w9 = ((((w7) >> (17)) | ((w7) << (32 - 17))) ^ (((w7) >> (19)) | ((w7) << (32 - 19))) ^ ((w7) >> (10))) + w2 + ((((w10) >> (7)) | ((w10) << (32 - 7))) ^ (((w10) >> (18)) | ((w10) << (32 - 18))) ^ ((w10) >> (3))) + w9;
				;
				w10 = ((((w8) >> (17)) | ((w8) << (32 - 17))) ^ (((w8) >> (19)) | ((w8) << (32 - 19))) ^ ((w8) >> (10))) + w3 + ((((w11) >> (7)) | ((w11) << (32 - 7))) ^ (((w11) >> (18)) | ((w11) << (32 - 18))) ^ ((w11) >> (3))) + w10;
				;
				w11 = ((((w9) >> (17)) | ((w9) << (32 - 17))) ^ (((w9) >> (19)) | ((w9) << (32 - 19))) ^ ((w9) >> (10))) + w4 + ((((w12) >> (7)) | ((w12) << (32 - 7))) ^ (((w12) >> (18)) | ((w12) << (32 - 18))) ^ ((w12) >> (3))) + w11;
				;
				w12 = ((((w10) >> (17)) | ((w10) << (32 - 17))) ^ (((w10) >> (19)) | ((w10) << (32 - 19))) ^ ((w10) >> (10))) + w5 + ((((w13) >> (7)) | ((w13) << (32 - 7))) ^ (((w13) >> (18)) | ((w13) << (32 - 18))) ^ ((w13) >> (3))) + w12;
				;
				w13 = ((((w11) >> (17)) | ((w11) << (32 - 17))) ^ (((w11) >> (19)) | ((w11) << (32 - 19))) ^ ((w11) >> (10))) + w6 + ((((w14) >> (7)) | ((w14) << (32 - 7))) ^ (((w14) >> (18)) | ((w14) << (32 - 18))) ^ ((w14) >> (3))) + w13;
				;
				w14 = ((((w12) >> (17)) | ((w12) << (32 - 17))) ^ (((w12) >> (19)) | ((w12) << (32 - 19))) ^ ((w12) >> (10))) + w7 + ((((w15) >> (7)) | ((w15) << (32 - 7))) ^ (((w15) >> (18)) | ((w15) << (32 - 18))) ^ ((w15) >> (3))) + w14;
				;
				w15 = ((((w13) >> (17)) | ((w13) << (32 - 17))) ^ (((w13) >> (19)) | ((w13) << (32 - 19))) ^ ((w13) >> (10))) + w8 + ((((w0) >> (7)) | ((w0) << (32 - 7))) ^ (((w0) >> (18)) | ((w0) << (32 - 18))) ^ ((w0) >> (3))) + w15;
				;



				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xe49b69c1 + w0;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xefbe4786 + w1;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x0fc19dc6 + w2;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x240ca1cc + w3;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x2de92c6f + w4;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x4a7484aa + w5;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x5cb0a9dc + w6;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x76f988da + w7;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x983e5152 + w8;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xa831c66d + w9;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xb00327c8 + w10;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xbf597fc7 + w11;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xc6e00bf3 + w12;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xd5a79147 + w13;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x06ca6351 + w14;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x14292967 + w15;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;



				w0 = ((((w14) >> (17)) | ((w14) << (32 - 17))) ^ (((w14) >> (19)) | ((w14) << (32 - 19))) ^ ((w14) >> (10))) + w9 + ((((w1) >> (7)) | ((w1) << (32 - 7))) ^ (((w1) >> (18)) | ((w1) << (32 - 18))) ^ ((w1) >> (3))) + w0;
				;
				w1 = ((((w15) >> (17)) | ((w15) << (32 - 17))) ^ (((w15) >> (19)) | ((w15) << (32 - 19))) ^ ((w15) >> (10))) + w10 + ((((w2) >> (7)) | ((w2) << (32 - 7))) ^ (((w2) >> (18)) | ((w2) << (32 - 18))) ^ ((w2) >> (3))) + w1;
				;
				w2 = ((((w0) >> (17)) | ((w0) << (32 - 17))) ^ (((w0) >> (19)) | ((w0) << (32 - 19))) ^ ((w0) >> (10))) + w11 + ((((w3) >> (7)) | ((w3) << (32 - 7))) ^ (((w3) >> (18)) | ((w3) << (32 - 18))) ^ ((w3) >> (3))) + w2;
				;
				w3 = ((((w1) >> (17)) | ((w1) << (32 - 17))) ^ (((w1) >> (19)) | ((w1) << (32 - 19))) ^ ((w1) >> (10))) + w12 + ((((w4) >> (7)) | ((w4) << (32 - 7))) ^ (((w4) >> (18)) | ((w4) << (32 - 18))) ^ ((w4) >> (3))) + w3;
				;
				w4 = ((((w2) >> (17)) | ((w2) << (32 - 17))) ^ (((w2) >> (19)) | ((w2) << (32 - 19))) ^ ((w2) >> (10))) + w13 + ((((w5) >> (7)) | ((w5) << (32 - 7))) ^ (((w5) >> (18)) | ((w5) << (32 - 18))) ^ ((w5) >> (3))) + w4;
				;
				w5 = ((((w3) >> (17)) | ((w3) << (32 - 17))) ^ (((w3) >> (19)) | ((w3) << (32 - 19))) ^ ((w3) >> (10))) + w14 + ((((w6) >> (7)) | ((w6) << (32 - 7))) ^ (((w6) >> (18)) | ((w6) << (32 - 18))) ^ ((w6) >> (3))) + w5;
				;
				w6 = ((((w4) >> (17)) | ((w4) << (32 - 17))) ^ (((w4) >> (19)) | ((w4) << (32 - 19))) ^ ((w4) >> (10))) + w15 + ((((w7) >> (7)) | ((w7) << (32 - 7))) ^ (((w7) >> (18)) | ((w7) << (32 - 18))) ^ ((w7) >> (3))) + w6;
				;
				w7 = ((((w5) >> (17)) | ((w5) << (32 - 17))) ^ (((w5) >> (19)) | ((w5) << (32 - 19))) ^ ((w5) >> (10))) + w0 + ((((w8) >> (7)) | ((w8) << (32 - 7))) ^ (((w8) >> (18)) | ((w8) << (32 - 18))) ^ ((w8) >> (3))) + w7;
				;
				w8 = ((((w6) >> (17)) | ((w6) << (32 - 17))) ^ (((w6) >> (19)) | ((w6) << (32 - 19))) ^ ((w6) >> (10))) + w1 + ((((w9) >> (7)) | ((w9) << (32 - 7))) ^ (((w9) >> (18)) | ((w9) << (32 - 18))) ^ ((w9) >> (3))) + w8;
				;
				w9 = ((((w7) >> (17)) | ((w7) << (32 - 17))) ^ (((w7) >> (19)) | ((w7) << (32 - 19))) ^ ((w7) >> (10))) + w2 + ((((w10) >> (7)) | ((w10) << (32 - 7))) ^ (((w10) >> (18)) | ((w10) << (32 - 18))) ^ ((w10) >> (3))) + w9;
				;
				w10 = ((((w8) >> (17)) | ((w8) << (32 - 17))) ^ (((w8) >> (19)) | ((w8) << (32 - 19))) ^ ((w8) >> (10))) + w3 + ((((w11) >> (7)) | ((w11) << (32 - 7))) ^ (((w11) >> (18)) | ((w11) << (32 - 18))) ^ ((w11) >> (3))) + w10;
				;
				w11 = ((((w9) >> (17)) | ((w9) << (32 - 17))) ^ (((w9) >> (19)) | ((w9) << (32 - 19))) ^ ((w9) >> (10))) + w4 + ((((w12) >> (7)) | ((w12) << (32 - 7))) ^ (((w12) >> (18)) | ((w12) << (32 - 18))) ^ ((w12) >> (3))) + w11;
				;
				w12 = ((((w10) >> (17)) | ((w10) << (32 - 17))) ^ (((w10) >> (19)) | ((w10) << (32 - 19))) ^ ((w10) >> (10))) + w5 + ((((w13) >> (7)) | ((w13) << (32 - 7))) ^ (((w13) >> (18)) | ((w13) << (32 - 18))) ^ ((w13) >> (3))) + w12;
				;
				w13 = ((((w11) >> (17)) | ((w11) << (32 - 17))) ^ (((w11) >> (19)) | ((w11) << (32 - 19))) ^ ((w11) >> (10))) + w6 + ((((w14) >> (7)) | ((w14) << (32 - 7))) ^ (((w14) >> (18)) | ((w14) << (32 - 18))) ^ ((w14) >> (3))) + w13;
				;
				w14 = ((((w12) >> (17)) | ((w12) << (32 - 17))) ^ (((w12) >> (19)) | ((w12) << (32 - 19))) ^ ((w12) >> (10))) + w7 + ((((w15) >> (7)) | ((w15) << (32 - 7))) ^ (((w15) >> (18)) | ((w15) << (32 - 18))) ^ ((w15) >> (3))) + w14;
				;
				w15 = ((((w13) >> (17)) | ((w13) << (32 - 17))) ^ (((w13) >> (19)) | ((w13) << (32 - 19))) ^ ((w13) >> (10))) + w8 + ((((w0) >> (7)) | ((w0) << (32 - 7))) ^ (((w0) >> (18)) | ((w0) << (32 - 18))) ^ ((w0) >> (3))) + w15;
				;



				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x27b70a85 + w0;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x2e1b2138 + w1;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x4d2c6dfc + w2;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x53380d13 + w3;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x650a7354 + w4;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x766a0abb + w5;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x81c2c92e + w6;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x92722c85 + w7;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xa2bfe8a1 + w8;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xa81a664b + w9;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xc24b8b70 + w10;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xc76c51a3 + w11;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xd192e819 + w12;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xd6990624 + w13;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xf40e3585 + w14;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x106aa070 + w15;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;



				w0 = ((((w14) >> (17)) | ((w14) << (32 - 17))) ^ (((w14) >> (19)) | ((w14) << (32 - 19))) ^ ((w14) >> (10))) + w9 + ((((w1) >> (7)) | ((w1) << (32 - 7))) ^ (((w1) >> (18)) | ((w1) << (32 - 18))) ^ ((w1) >> (3))) + w0;
				;
				w1 = ((((w15) >> (17)) | ((w15) << (32 - 17))) ^ (((w15) >> (19)) | ((w15) << (32 - 19))) ^ ((w15) >> (10))) + w10 + ((((w2) >> (7)) | ((w2) << (32 - 7))) ^ (((w2) >> (18)) | ((w2) << (32 - 18))) ^ ((w2) >> (3))) + w1;
				;
				w2 = ((((w0) >> (17)) | ((w0) << (32 - 17))) ^ (((w0) >> (19)) | ((w0) << (32 - 19))) ^ ((w0) >> (10))) + w11 + ((((w3) >> (7)) | ((w3) << (32 - 7))) ^ (((w3) >> (18)) | ((w3) << (32 - 18))) ^ ((w3) >> (3))) + w2;
				;
				w3 = ((((w1) >> (17)) | ((w1) << (32 - 17))) ^ (((w1) >> (19)) | ((w1) << (32 - 19))) ^ ((w1) >> (10))) + w12 + ((((w4) >> (7)) | ((w4) << (32 - 7))) ^ (((w4) >> (18)) | ((w4) << (32 - 18))) ^ ((w4) >> (3))) + w3;
				;
				w4 = ((((w2) >> (17)) | ((w2) << (32 - 17))) ^ (((w2) >> (19)) | ((w2) << (32 - 19))) ^ ((w2) >> (10))) + w13 + ((((w5) >> (7)) | ((w5) << (32 - 7))) ^ (((w5) >> (18)) | ((w5) << (32 - 18))) ^ ((w5) >> (3))) + w4;
				;
				w5 = ((((w3) >> (17)) | ((w3) << (32 - 17))) ^ (((w3) >> (19)) | ((w3) << (32 - 19))) ^ ((w3) >> (10))) + w14 + ((((w6) >> (7)) | ((w6) << (32 - 7))) ^ (((w6) >> (18)) | ((w6) << (32 - 18))) ^ ((w6) >> (3))) + w5;
				;
				w6 = ((((w4) >> (17)) | ((w4) << (32 - 17))) ^ (((w4) >> (19)) | ((w4) << (32 - 19))) ^ ((w4) >> (10))) + w15 + ((((w7) >> (7)) | ((w7) << (32 - 7))) ^ (((w7) >> (18)) | ((w7) << (32 - 18))) ^ ((w7) >> (3))) + w6;
				;
				w7 = ((((w5) >> (17)) | ((w5) << (32 - 17))) ^ (((w5) >> (19)) | ((w5) << (32 - 19))) ^ ((w5) >> (10))) + w0 + ((((w8) >> (7)) | ((w8) << (32 - 7))) ^ (((w8) >> (18)) | ((w8) << (32 - 18))) ^ ((w8) >> (3))) + w7;
				;
				w8 = ((((w6) >> (17)) | ((w6) << (32 - 17))) ^ (((w6) >> (19)) | ((w6) << (32 - 19))) ^ ((w6) >> (10))) + w1 + ((((w9) >> (7)) | ((w9) << (32 - 7))) ^ (((w9) >> (18)) | ((w9) << (32 - 18))) ^ ((w9) >> (3))) + w8;
				;
				w9 = ((((w7) >> (17)) | ((w7) << (32 - 17))) ^ (((w7) >> (19)) | ((w7) << (32 - 19))) ^ ((w7) >> (10))) + w2 + ((((w10) >> (7)) | ((w10) << (32 - 7))) ^ (((w10) >> (18)) | ((w10) << (32 - 18))) ^ ((w10) >> (3))) + w9;
				;
				w10 = ((((w8) >> (17)) | ((w8) << (32 - 17))) ^ (((w8) >> (19)) | ((w8) << (32 - 19))) ^ ((w8) >> (10))) + w3 + ((((w11) >> (7)) | ((w11) << (32 - 7))) ^ (((w11) >> (18)) | ((w11) << (32 - 18))) ^ ((w11) >> (3))) + w10;
				;
				w11 = ((((w9) >> (17)) | ((w9) << (32 - 17))) ^ (((w9) >> (19)) | ((w9) << (32 - 19))) ^ ((w9) >> (10))) + w4 + ((((w12) >> (7)) | ((w12) << (32 - 7))) ^ (((w12) >> (18)) | ((w12) << (32 - 18))) ^ ((w12) >> (3))) + w11;
				;
				w12 = ((((w10) >> (17)) | ((w10) << (32 - 17))) ^ (((w10) >> (19)) | ((w10) << (32 - 19))) ^ ((w10) >> (10))) + w5 + ((((w13) >> (7)) | ((w13) << (32 - 7))) ^ (((w13) >> (18)) | ((w13) << (32 - 18))) ^ ((w13) >> (3))) + w12;
				;
				w13 = ((((w11) >> (17)) | ((w11) << (32 - 17))) ^ (((w11) >> (19)) | ((w11) << (32 - 19))) ^ ((w11) >> (10))) + w6 + ((((w14) >> (7)) | ((w14) << (32 - 7))) ^ (((w14) >> (18)) | ((w14) << (32 - 18))) ^ ((w14) >> (3))) + w13;
				;
				w14 = ((((w12) >> (17)) | ((w12) << (32 - 17))) ^ (((w12) >> (19)) | ((w12) << (32 - 19))) ^ ((w12) >> (10))) + w7 + ((((w15) >> (7)) | ((w15) << (32 - 7))) ^ (((w15) >> (18)) | ((w15) << (32 - 18))) ^ ((w15) >> (3))) + w14;
				;
				w15 = ((((w13) >> (17)) | ((w13) << (32 - 17))) ^ (((w13) >> (19)) | ((w13) << (32 - 19))) ^ ((w13) >> (10))) + w8 + ((((w0) >> (7)) | ((w0) << (32 - 7))) ^ (((w0) >> (18)) | ((w0) << (32 - 18))) ^ ((w0) >> (3))) + w15;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x19a4c116 + w0;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x1e376c08 + w1;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x2748774c + w2;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x34b0bcb5 + w3;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x391c0cb3 + w4;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x4ed8aa4a + w5;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x5b9cca4f + w6;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x682e6ff3 + w7;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x748f82ee + w8;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x78a5636f + w9;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x84c87814 + w10;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x8cc70208 + w11;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0x90befffa + w12;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xa4506ceb + w13;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xbef9a3f7 + w14;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;


				T1 = h + ((((e) >> (6)) | ((e) << (32 - 6))) ^ (((e) >> (11)) | ((e) << (32 - 11))) ^ (((e) >> (25)) | ((e) << (32 - 25)))) + (((e) & (f)) ^ (~e & (g))) + 0xc67178f2 + w15;
				T2 = ((((a) >> (2)) | ((a) << (32 - 2))) ^ (((a) >> (13)) | ((a) << (32 - 13))) ^ (((a) >> (22)) | ((a) << (32 - 22)))) + (((a) & (b)) ^ ((a) & (c)) ^ ((b) & (c)));
				h = g;
				g = f;
				f = e;
				e = d + T1;
				d = c;
				c = b;
				b = a;
				a = T1 + T2;
				;



				a += state[0];
				b += state[1];
				c += state[2];
				d += state[3];
				e += state[4];
				f += state[5];
				g += state[6];
				h += state[7];

				state[0] = a;
				state[1] = b;
				state[2] = c;
				state[3] = d;
				state[4] = e;
				state[5] = f;
				state[6] = g;
				state[7] = h;

				in_buf_offset += 64;
				inlen -= 64;
			}

			store_bigendian_32(statebytes, 0, state[0]);
			store_bigendian_32(statebytes, 4, state[1]);
			store_bigendian_32(statebytes, 8, state[2]);
			store_bigendian_32(statebytes, 12, state[3]);
			store_bigendian_32(statebytes, 16, state[4]);
			store_bigendian_32(statebytes, 20, state[5]);
			store_bigendian_32(statebytes, 24, state[6]);
			store_bigendian_32(statebytes, 28, state[7]);

			return inlen;
		}
	}
}